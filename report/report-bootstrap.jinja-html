<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous" />
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
    crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
    crossorigin="anonymous"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      renderMathInElement(document.body, {
        // customized options
        // • auto-render specific keys, e.g.:
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false },
          { left: "\\[", right: "\\]", display: true },
        ],
        // • rendering keys, e.g.:
        throwOnError: false,
      });
    });
  </script>

  <!-- fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap"
    rel="stylesheet" />
  <!-- plotly.js -->
  <script src="assets/js/plotly-basic.min.js"></script>

  <!-- data for interactive/plotly figures -->

  <meta name="description" content="bsDoctor: quality diagnosis of bisulfite-seq data">
  <meta name="author" content="Yance Feng">
  <title>{{ alldata.title }}</title>

  <!-- JSON plot data -->
  <script type="text/plain" id="alldata">{{ alldata|tojson }}</script>
  
  {# <script type="text/plain" id="config">{{ config|tojson }}</script> #}

  <script type="text/javascript">
    alldata = JSON.parse(document.getElementById('alldata').innerHTML);
    // config = JSON.parse(document.getElementById('config').innerHTML);
  </script>


</head>
<!-- <body class="p-3 m-0 border-0 bd-example m-0 border-0 bd-example-row"> -->

<body class="">
  <!-- <div class="container"> -->
  <!-- <div class=""> -->
  <div class="row text-center">
    <div class="col">
      <h1>
        bsDoctor: Quality Diagnosis for Bisulfite-Seq Data
      </h1>
      <p class="text-sample">Sample: {{alldata.SAMPLE}}</p>
    </div>
  </div>

  <div class="row text-left">
    <div class="col-2">
      <aside class="bd-sidebar">
        <div class="accordion" id="accordionPanels">
          <div class="accordion-item">
            <!-- <div class="accordion-header"> -->
            <button class="accordion-button collapsed" type="button">
              <a class="nav-link" href="#Summary">Summary</a>
            </button>

            <!-- </div> -->
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panel-quality" aria-expanded="false" aria-controls="panel-quality">
                Base and read quality
              </button>
            </div>
            <div id="panel-quality" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#base-quality">base quality</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#read-length">read length</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#mapping-quality">read mapping quality</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#cigar">CIGAR distribution</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panelsStayOpen-Bisulfite-conversion" aria-expanded="false"
                aria-controls="panelsStayOpen-Bisulfite-conversion">
                Bisulfite conversion
              </button>
            </div>
            <div id="panelsStayOpen-Bisulfite-conversion" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#Bisulfite-conversion">Bisulfite conversion rate</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#adjust-meth">Adjust DNAme level</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button">
                <a class="nav-link" href="#error">Base-level error</a>
              </button>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panel-Saturation-curve" aria-expanded="false" aria-controls="panel-Saturation-curve">
                Saturation curve
              </button>
            </div>
            <div id="panel-Saturation-curve" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#sc-curve">Single-stranded saturation curve</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#DNA-template-lose">DNA template lose</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panel-mt" aria-expanded="false" aria-controls="panel-mt">
                Mitochondrion
              </button>
            </div>
            <div id="panel-mt" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#mt-coverage">Read depth</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#mt-dna-copy-number">DNA copy number</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#mt-conversion">Bisulfite conversion</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#mt-error">Error rate</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panel-lambda" aria-expanded="false" aria-controls="panel-lambda">
                Unmethylated control DNA
              </button>
            </div>
            <div id="panel-lambda" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#lambda-coverage">Read depth</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#lambda-dna-content">DNA content</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#lambda-conversion">Bisulfite conversion</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#lambda-error">Error rate</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panelsStayOpen-Genome-Coverage" aria-expanded="false"
                aria-controls="panelsStayOpen-Genome-Coverage">
                Genome Coverage
              </button>
            </div>
            <div id="panelsStayOpen-Genome-Coverage" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#binning-coverage">Binning coverage</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#depth-distribution">Depth distribution</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#Genome-coverage">Genome coverage</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#cg-depth-distribution">CpG depth distribution</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#cg-coverage">CpG coverage rate</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panelsStayOpen-Methylation-level" aria-expanded="false"
                aria-controls="panelsStayOpen-Methylation-level">
                Methylation level
              </button>
            </div>
            <div id="panelsStayOpen-Methylation-level" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#genome-feature-methylation">Methylation levels of genome features</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#chr-methylation">Methylation levels of chromosomes</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#binning-methylation">Binning methylation</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#pan-gene-methylation">Pan-gene methylation</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panelsStayOpen-Bias" aria-expanded="false" aria-controls="panelsStayOpen-Bias">
                Methylation bias
              </button>
            </div>
            <div id="panelsStayOpen-Bias" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#meth-at-depth">DNAme for depth = k</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#cul-meth-depth">DNAme for depth >= k</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#meth-vs-missing-rate">DNAme vs missing rate</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#meth-vs-cg-density">DNAme vs CpG density</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#depth-distribution-of-low-high-meth-cpg">Depth distribution of low/high
                      DNAme sites</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panel-CpG-strandness" aria-expanded="false" aria-controls="panel-CpG-strandness">
                CpG strandness
              </button>
            </div>
            <div id="panel-CpG-strandness" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-stranded-depth">CpG depth strandness</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-depth-diff">Stranded depth difference</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-double-stranded-coverage">CpGs of double-stranded coverage</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-stranded-meth">CpG methylation strandness</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-stranded-meth-diff">CpG stranded methylation difference</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panelsStayOpen-CpG-kmer" aria-expanded="false" aria-controls="panelsStayOpen-CpG-kmer">
                CpG-kmer
              </button>
            </div>
            <div id="panelsStayOpen-CpG-kmer" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-kmer-frequency">CpG-kmer frequency</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#stranded-CpG-kmer-frequency">Stranded CpG-kmer frequency</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-kmer-meth-vs-frequency">CpG-kmer methylation vs frequency</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-kmer-coverage-vs-depth">CpG-kmer coverage vs depth</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#CpG-kmer-meth-vs-depth">CpG-kmer methylation vs depth</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <div class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                data-bs-target="#panel-pan-gene" aria-expanded="false" aria-controls="panel-pan-gene">
                Pan-gene methylation
              </button>
            </div>
            <div id="panel-pan-gene" class="accordion-collapse collapse">
              <div class="accordion-body">
                <ul class="nav flex-column nav-underline">
                  <li class="nav-item">
                    <a class="nav-link" href="#pan-gene-coding">Coding genes</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#pan-gene-lnc">lncRNA genes</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#pan-gene-other">Other non-coding genes</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </aside>
    </div>

    <div class="col-8" id="main-content">
      <section class="first-section" id="Summary">
        <h2 class="first-header">Summary</h2>
      </section>

      <section id="base-read-quality">
        <h2>Base and read quality</h2>
        <p>
          The statistics are based on {{alldata.quality_nreads}} reads containing {{ alldata.quality_nbases}} bases
          sampled from {{alldata.quality_nloci}} random loci.
        </p>

        <article class="my-3" id="base-quality">
          <div class="row">
            <div class="col">
              <p class="text-center title">Base quality</p>
              <img src="../img/hist-base-quality.png" alt="" width="400px" />
            </div>
            <div class="col">
              <p class="text-center title">Read length</p>
              <img src="../img/hist-read-length.png" alt="" width="400px" />
            </div>
          </div>
          <div class="row">
            <div class="col">
              <p class="text-center title">Read mapping quality</p>
              <img src="../img/hist-read-map-quality.png" alt="" width="400px" />
            </div>
            <div class="col">
              <p id="cap-cigar" class="text-center title">
                Bases of each kind of CIGAR<sup class="question-marker">?</sup>
                status
              </p>
              <div class="caption" link="#cap-cigar">
                CIGAR(<strong>C</strong>ompact <strong>I</strong>diosyncratic
                <strong>G</strong>apped <strong>A</strong>lignment
                <strong>R</strong>eport) is reported by aligner,
                <ul>
                  <li>M: alignment match</li>
                  <li>I: insertion</li>
                  <li>D: deletion</li>
                  <li>N: skipped region</li>
                  <li>S: soft clipping</li>
                  <li>H: hard clipping</li>
                  <li>P: padding</li>
                  <li>=: sequence match</li>
                  <li>X: sequence mismatch</li>
                  <li>B: backwards skip</li>
                </ul>
              </div>
              <img src="../img/bar-base-CIGAR.png" alt="" width="400px" />
            </div>
          </div>


        </article>

      </section>

      <section id="Bisulfite-conversion">
        <h2>Bisulfite conversion</h2>

        <article id="bs-conversion">
          <h3>Conversion rate</h3>
          <ul>
            {% if alldata.lambda_is_covered == 1 %}
            <li>
              {{ alldata.bsrate_lambda }}%: from unmethylated control DNA (usually lambda DNA, {{alldata.lambda_nCorG}} cytosines);
            </li>
            {% endif %}
            {% if alldata.mt_is_covered == 1 %}
            <li>
              {{ alldata.bsrate_mt}}%: from mitochondrial DNA<sup class="question-marker">?</sup> ({{alldata.mt_nCorG}} cytosines);
            </li>
            {% endif %}
            <li id="cap-chh">
              {{ alldata.bsrate_chh}}%: from nuclear CHHs<sup class="question-marker0">?</sup>
              ({{alldata.nCHH}} cytosines sampled);
            </li>
            <div class="caption" link="#cap-chh">
              These estimates are available only for samples that MT DNA/nuclear CHHs are of no/little methylation.
            </div>
          </ul>
          {# alert of low conversion rate #}
          {% if alldata.bsrate_warning == 1 %}
          <div class="alert alert-warning" role="alert">
            Warning! Too low conversion rate.
          </div>
          {% endif %}
        </article>

        <article id="adjust-meth">
          <h3>Adjust DNAme level</h3>
          <p>DNAme bias, i.e., observed DNAme level - real DNAme level, is dependent on (observed/unadjusted) DNAme
            level and bisulfite conversion rate. The theoretical relationsip is illustrated by the following figure.</p>
          <img src="../img/DNAme-bias.png" alt="" width="450px" />
          <p>
            Adjust (whole-genome) DNAme level according to incomplete bisulfite conversion. <sup
              class="question-marker">?</sup> The conversion rate of {{ alldata.bs_rate }}% is adopted.
          <div class="caption" link="#cap-3">
            Over-conversion is inestimable in usual samples and not modeled in bsDoctor.
          </div>
          </p>
          <ul>
            <li id="cap-3">
              CGs (depth ≥ 1): observed: {{ alldata.me_CG }}%, adjusted: {{ alldata.me_CG_adj }}%;
            </li>
            <li>CHGs (depth ≥ 1): observed: {{ alldata.me_CHG }}%, adjusted: {{ alldata.me_CHG_adj }}%;</li>
            <li>CHHs (depth ≥ 1): observed: {{ alldata.me_CHH }}%, adjusted: {{ alldata.me_CHH_adj }}%.</li>
          </ul>
          {# alert of low conversion rate #}
          {% if alldata.bsrate_warning == 1 %}
          <div class="alert alert-warning" role="alert">
            Warning!
            The adjustment may be problematic because of too low conversion rate.
          </div>
          {% endif %}
        </article>
      </section>

      <section id="error">
        <article>
          <h2>Base-level error</h2>
          <p>
            The base-level error, assuming the reads are mapped to correct genomic positions, is estimated by the
            proportion of inconsistent bases,
            namely <sup class="question-marker" id="cap3-1">?</sup>
          <div class="caption" link="#cap3-1">Only available when mutation rate is much less than error rate.</div>
          {% raw %}
          $$ \text {error rate} = \frac {\text {\#\{inconsistent
          bases with reference\} }} {\#\text{\{total mapped bases\}}}. $$
          {% endraw %}
          </p>
          <ul>
            <li id="cap-4">
              For nuclear genome, from bases mapped to A/T sites<sup class="question-marker">?</sup>: {{ alldata.err_rate_AT }}%;
            </li>
            <div class="caption" link="#cap-4">
              Most single-nucleotide variations (SNVs) are C → T and
              G → A.
            </div>
            {% if alldata.mt_is_covered == 1 %}
            <li>For mitochondrial genome: {{ alldata.err_rate_mt }}% </li>
            {% endif %}
            {% if alldata.lambda_is_covered == 1 %}
            <li>For spike-in unmethylated control DNA: {{ alldata.err_rate_lambda }}%</li>
            {% endif %}
          </ul>

          The error rate histogram of each {{alldata.bin_size}} binning window of nuclear chromosomes is
          <img src="../img/base-error-rate-by-AT.png" alt="" width="400px" />
        </article>
      </section>

      <section id="Saturation curve">
        <h2>Saturation curve</h2>
        <article id="sc-curve">
          <h3>Single-stranded saturation curve</h3>
          <p>
            The strand difference is essential for bisulfite sequencing. As
            the sequenced reads increase, the genome coverage increases. bsDoctor
            simulates the process by sampling the mapped reads/bases
            hypergeometrically.
          </p>
          <p>
            In the following figure, x-axis represents single-stranded sequencing
            depth, y-axis represents single-stranded whole-genome coverage. The dashed line is the estimated asymptotic
            whole-genome coverage if this library is sequenced continuously.
          </p>
          <img src="../img/saturation-curve.png" alt="" width="500px" />
        </article>

        <article id="DNA-template-loss">
          <h3>DNA template lose</h3>
          <p>
            The part of (nuclear) DNA that degraded during library
            construction and the part of undegraded but not sequenced DNA can
            be estimated with empirical Bayes model<sup id="cap-5" class="question-marker">?</sup>.
          </p>
          <div class="caption" link="#cap-5">
            Refer to
            <a href="https://doi.org/10.1017/CBO9781316576533">Efron and Hastie (2016)</a>
            Chapter 6 for more information of empirical Bayes model.
          </div>
          <ul>
            <li>sequenced (depth ≥ 1): {{alldata.prop_cov_DP1}}% </li>
            <li>undegraded but not sequenced: {{ alldata.prop_unsequenced }}% </li>
            <li>
              degenerated: {{ alldata.prop_lost }}% <sup id="cap-6" class="question-marker">?</sup>
            </li>
            <div class="caption" link="#cap-6">
              For single-cell samples, it is usually a serious problem.
            </div>
            <li>ultimate coverage (by sequencing continuously): {{alldata.prop_cov_DP1}}% + {{ alldata.prop_unsequenced }}% = {{ alldata.prop_asymptotic }}%</li>
            <li>saturation: {{ alldata.saturaion }}% </li>
          </ul>
          
          <img src="../img/pie-DNA-lost.png" alt="" height="200px" />
        </article>

        <article id="DNA-composition">
          <h3>DNA composition</h3>
          <p>The DNA content of nuclear, mitochondria, plastids, and spikied-in (lambda) DNA in the library is proportional to reads mapped to coorresponding chromosomes/contigs.</p>
          <img src="../img/pie-DNA-content.png" alt="" height="200px" />
        </article>
      </section>

      {% if alldata.mt_is_covered == 1 %}

      <section id="mt">
        <h2>Mitochondrion</h2>

        <article id="mt-coverage">
        <ul>
          <li>{{ alldata.mt_length }} non-N bps in total, whereas {{ alldata.mt_cov_prop }} are covered ({{ alldata.mt_covn }} bp
            for depth ≥ 1);</li>
          <li>{{ alldata.mt_nCorG }} cytosines in total, whereas {{ alldata.mt_covnCorG_prop }} are covered ({{
            alldata.mt_covnCorG }} cytosines for
            depth ≥ 1).</li>
        </ul>
          <h3>Read depth</h3>
          <p>
            Mean read depth of {{ alldata.mt_bin_size }}bp binning windows for Watson strand (top), Crick strand (middle), and double strands (bottom).
          </p>
          <img src="../img/depth-bin-MT.png" alt="" width="300px" id="cap-15" />
          <div class="caption" link="#cap-15">
            Check the uniformness of read coverage.
          </div>
        </article>

        <article id="mt-dna-copy-number">
          <h3>DNA copy number</h3>
          <p>
            Mitochondrion DNA copy number is estimated by the average depth of MTs over
            that of nuclear chromosomes. <sup id="cap-7" class="question-marker">?</sup>
          <div class="caption" link="#cap-7">
            The estimate is less accurate for RRBS samples than WGBS samples due to selective enrichment of DNA fragments. <br>
            Change the coefficient accordingly if not diploidy.
          </div>
          {% raw %} $$ \text{MT DNA copy number} = \frac{ {% endraw %} {{ alldata.mt_mean_dp}} {% raw %} }{ {% endraw %} {{
          alldata.mean_dp }} {% raw %} } \times 2
          (\text{diploidy}) = {% endraw %} {{ alldata.mt_copynum }} $$
          </p>
        </article>

        <article id="mt-conversion">
          <h3>Bisulfite conversion</h3>
          <p>
            From the 'methylation' of cytosines in MT genome
            <sup id="cap-8" class="question-marker">?</sup>, we can estimate
            bisulfite conversion rate as $$ \text{conversion rate} =
            1-\text{MT methylation level} = 1 - {{ alldata.mt_me }} = {{ alldata.bsrate_mt }}\%. $$
          </p>
          <div class="caption" link="#cap-8">
            According to the author's knowledge, no evidence suggests there is 5-Methylcytosine (5mC) modification on MT DNA at least for mammals.
          </div>
        </article>

        <article id="mt-error">
          <h3>Error rate</h3>
          <p>
            The (base-level) error rate that a base is mis-detected during library
            preparation, sequencing, and alignment, can be estimated
            <sup id="cap-9" class="question-marker">?</sup> from inconsistent
            bases mapped to MT genome. From the error rate distribution of
            20-bp binning windows, the average error rate is $$ \text{error rate} =
            \frac{\text{bases different with dominating base}}{\text{total read
            bases}} = {{ alldata.err_rate_mt}} \%. $$
          </p>
          <div class="caption" link="#cap-9">
            Mutation rate is much smaller than error rate in bisulfite-seq samples.
          </div>
          <img src="../img/base-error-rate-dist-MT.png" alt="" width="400px" />
        </article>
      </section>
      {% endif %}

      {% if alldata.lambda_is_covered == 1 %}

      <section id="lambda">
        <h2>Unmethylated control DNA</h2>

        <article id="lambda-coverage">
          <p>
          <ul>
            <li>{{ alldata.lambda_length }} non-N bps in total, whereas {{ alldata.lambda_cov_prop }}% are covered
              ({{alldata.lambda_covn }} bps for depth ≥ 1);</li>
            <li>{{ alldata.lambda_nCorG }} cytosines in total, whereas {{ alldata.lambda_covnCorG_prop }}% are covered ({{
              alldata.lambda_covnCorG }} cytosines for
              depth ≥ 1).</li>
          </ul>
          </p>
          <h3>Read depth</h3>
          <p><ul>
            <li>Binnng size: {{alldata.lambda_size}} bp</li>
            <li>Read depth: {{alldata.lambda_mean_dp}}(mean), {{alldata.lambda_median_dp}}(median)</li>
          </ul>
          </p>
          <img src="../img/depth-bin-lambda.png" alt="" width="600px" id="cap-10" />
          <div class="caption" link="#cap-10">
            Check the uniformness of coverage depth
          </div>
        </article>
        <article id="lambda-dna-content">
          <h3>DNA content</h3>
          <p>
            The spike-in control DNA content
            <sup id="cap-11" class="question-marker">?</sup> with respect with
            MT DNA and nuclear DNA is $$ \frac{\text{lambda DNA}}{\text{MT
            DNA}} = {{alldata.lambda_DNA_content_vs_MT}}\%, $$ $$ \frac{\text{lambda DNA}}{\text{nuclear
            DNA}} = {{alldata.lambda_DNA_content_vs_nuclear}}\%. $$
          </p>
          <div class="caption" link="#cap-11">
            Check whether the content of spike-in DNA is appropriate.
          </div>
        </article>
        <article id="lambda-conversion">
          <h3>Bisulfite conversion</h3>
          <p>
            From the 'methylation' of cytosines in control DNA, we can
            estimate bisulfite conversion rate
            <sup id="cap-12" class="question-marker">?</sup> as $$
            \text{conversion rate} = 1-\text{control DNA methylation level} =
            {{alldata.bsrate_lambda}}\%. $$
          </p>
          <div class="caption" link="#cap-12">
            The actual estimate of 'methylation level' is the median of
            methylation of each bin which is robust.
          </div>
        </article>
        <article id="lambda-error">
          <h3>Error rate</h3>
          <p>
            The error rate that a base is mis-detected during library
            preparation, sequencing, and alignment, can be estimated from
            inconsistent bases mapped to control DNA. From the error rate
            distribution of 50-bp bins, the average error rate
            <sup id="cap-13" class="question-marker">?</sup> is 
            
            $$ \text{error
            rate} = \frac{\text{bases different with reference
            base}}{\text{total bases}} = {{alldata.err_rate_lambda}}\%. $$
          </p>
          <div class="caption" link="#cap-13">
            The actual error rate estimate is the median of each bin which is
            robust.
          </div>
          <img src="../img/base-error-rate-dist-lambda.png" alt="" width="400px" />
        </article>
      </section>
      {% endif %}

      <section id="Genome-Coverage">
        <h2>Genome Coverage</h2>

        <article id="binning-coverage">
          <h3>Binning coverage</h3>
          <p>
            Each point represents the mean coverage depth of each 100k bp
            binning window. The outliers are truncated <em>y</em>-axis limit.
          </p>

          <div class="row">
            <div class="col-3"></div>
            <div class="col">
              <p class="label label-v">Strand</p>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="switch-4" checked />
                <label class="form-check-label" for="switch-4">Single-stranded</label>
              </div>
            </div>
            <div class="col" id="legend-depth-bin">
              <p class="label label-v">Color legend</p>
              <span class="watson-marker">·</span>Watson strand <br />
              <span class="crick-marker">·</span>Crick strand
            </div>
            <div class="col-3"></div>
          </div>
          <div class="row">
            <div class="col-xl-12">
              <div class="col-auto">
                <img src="../img/depth-bin-single.png" alt="" id="img-depth-bin" />
                <div class="caption" link="#img-depth-bin">
                  Check the uniformness of coverage depth of each strand and
                  whole genome.
                </div>
              </div>
            </div>
          </div>
        </article>

        <article id="depth-of-two-strands">
          <h3>Read depth of two strands</h3>
          <img src="../img/depth-of-two-strands.png" alt="" width="400px">
        </article>

        <article id="depth-distribution">
          <h3>Depth distribution and coverage</h3>
          <div class="row">
            <div class="col-6 text-center">
              <p>Mapped read depth of whole genome</p>
              <img src="../img/whole-genome-depth-distribution.png" alt="" width="400px" />
            </div>
            <div class="col-6 text-center">
              <p>Whole genome coverage rate</p>
              <img src="../img/whole-genome-coverage-vs-depth.png" alt="" width="400px" />
            </div>
          </div>
        </article>

        <article id="cg-depth-distribution">
          <h3>Cytosine depth distribution and coverage</h3>
          <p>
            Only the reads contributing to the calculation of DNAme level are
            included.<sup id="cap-16" class="question-marker">?</sup>
          </p>
          <div class="caption" link="#cap-16">
            Namely C/T reads for Watson strand and G/A reads for Crick strand.
          </div>

          <div class="row">
            <div class="col text-center">
              <p>Methylation read depth</p>
              <img src="../img/genome-CG-depth-distribution.png" alt="" width="400px" id="img-Cs-depth-dist" />
            </div>
            <div class="col text-center">
              <p>Cytosine coverage rate</p>
              <img src="../img/genome-CG-coverage-vs-depth.png" alt="" width="400px" id="img-Cs-depth-coverage" />
            </div>
            <div class="col" style="margin-top: 35px">
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-Cs-depth-dist" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-Cs-depth-dist" value="CHG" />
                <label class="form-check-label">CHG </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-Cs-depth-dist" value="CHH" />
                <label class="form-check-label">CHH </label>
              </div>
            </div>
          </div>
        </article>

        <article id="depth-vs-meth-depth">
          <h3>Methylation depth vs total depth</h3>
          <p>Available reads for methyaltion calculation is a subset of total reads.</p>
          <div class="row">
            <div class="col-9">
              <img src="../img/depth-vs-meth-depth-of-watson-strand.png" alt="" width="400px"
                id="img-depth-vs-meth-depth" />
              <div class="caption" link="#img-depth-vs-meth-depth"></div>
            </div>
            <div class="col legend">
              <p class="label">Strand</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-depth-vs-meth-depth" value="watson" checked />
                <label class="form-check-label">Watson</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-depth-vs-meth-depth" value="crick" />
                <label class="form-check-label">Crick</label>
              </div>
            </div>
          </div>
        </article>

        <article id="cov-rate-vs-cg-density">
          <h3>Cytosine coverage vs cytosine densities</h3>
          <p>
            The <strong>cytosine density</strong> of a genomic region (binning windows) is defined as the number of
            cytosines per
            1Kbp. Cytosines on two strands are summed for double-stranded
            plots.
          </p>
          <div class="row">
            <div class="col-9">
              <!-- <object type="image/svg+xml" data="../img/covrate-vs-CG-density-of-double-strand.svg" width="500"></object> -->

              <img src="../img/covrate-vs-CG-density-of-double-strand-dp-ge1.png" alt="" width="400px"
                id="img-cov-rate-vs-Cs-density" />
              <div class="caption" link="#img-cov-rate-vs-Cs-density"></div>
            </div>
            <div class="col legend">
              <p class="label">
                Depth ≥ <span id="label-covrate-vs-Cs-density">1</span>
              </p>
              <input type="range" class="form-range" min="1" max="10" step="1" id="range-covrate-vs-Cs-density"
                value="1" />

              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-cov-rate-vs-Cs-density" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-cov-rate-vs-Cs-density" value="CHG" />
                <label class="form-check-label">CHG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-cov-rate-vs-Cs-density" value="CHH" />
                <label class="form-check-label">CHH</label>
              </div>

              <p class="label">Strand</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-cov-rate-vs-Cs-density" value="double"
                  checked />
                <label class="form-check-label">Double</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-cov-rate-vs-Cs-density" value="W" />
                <label class="form-check-label">Watson</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-cov-rate-vs-Cs-density" value="C" />
                <label class="form-check-label">Crick</label>
              </div>
            </div>
          </div>
        </article>

        <article id="depth-vs-cg-density">
          <h3>Mean depth vs cytosine density</h3>
          <p>For each 100kbp binning window, mean read depth of all sites are plotted against cytosine density in this
            window with colour indicating the density of windows.</p>
          <div class="row">
            <div class="col-9">
              <img src="../img/depth-vs-CG-density-of-double-strand.png" alt="" width="400px"
                id="img-depth-vs-Cs-density" />
              <div class="caption" link="#img-depth-vs-Cs-density"></div>
            </div>
            <div class="col legend">
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-depth-vs-Cs-density" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-depth-vs-Cs-density" value="CHG" />
                <label class="form-check-label">CHG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-depth-vs-Cs-density" value="CHH" />
                <label class="form-check-label">CHH</label>
              </div>

              <p class="label">Strand</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-depth-vs-Cs-density" value="double" checked />
                <label class="form-check-label">Double</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-depth-vs-Cs-density" value="W" />
                <label class="form-check-label">Watson</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-depth-vs-Cs-density" value="C" />
                <label class="form-check-label">Crick</label>
              </div>
            </div>
          </div>
        </article>

      </section>

      <section id="Methylation level">
        <h2>Methylation level</h2>

        <article id="meth-wholegenome">
          <h3>Whole genome</h3>
          <p>
            Distribution of whole-genome methylation level with different
            depth thresholds (depth ≥ k).
          </p>
          <div class="row">
            <div class="col-8">
              <img src="../img/meth-dist-genome-CG-dp1.svg" alt="" width="500px" id="img-meth-dist" />
            </div>
            <div class="col-4 legend">
              <p class="label">Depth ≥ <span id="label-1">1</span></p>
              <input type="range" class="form-range" min="1" max="30" step="1" id="range-dp" value="1" />
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-1" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-1" value="CHG" />
                <label class="form-check-label">CHG </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-1" value="CHH" />
                <label class="form-check-label">CHH </label>
              </div>
            </div>
          </div>
        </article>

        <article id="chr-methylation">
          <h3>Whole chromosome/contig</h3>
          <p>Mean methylation level of each chromosomes/contigs.</p>
          <div class="row">
            <div class="col-8">
              <img src="../img/meth-chr-CG-double-dp1.svg" alt="" height="250px" id="img-meth-chr" />
            </div>
            <div class="col-4 legend">
              <p class="label">Depth ≥ <span id="label-2">1</span></p>
              <input type="range" class="form-range" min="1" max="30" step="1" id="range-2" value="1" />
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-2" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-2" value="CHG" />
                <label class="form-check-label">CHG </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-2" value="CHH" />
                <label class="form-check-label">CHH </label>
              </div>
            </div>
          </div>
        </article>

        <article id="binning-methylation">
          <h3>Binning methylation level</h3>
          <p>
            Each point represents the average methylation level (genome
            cytosine-wise average instead of read- or sequencing base-wise
            average) of each 100k base binning window.
          </p>
          <div class="row">
            <div class="col-2"></div>
            <div class="col-3">
              <p class="label label-v">Cytosine context</p>
              <div class="form-check col">
                <input class="form-check-input" type="radio" name="radio-3" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-3" value="CHG" />
                <label class="form-check-label">CHG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-3" value="CHH" />
                <label class="form-check-label">CHH</label>
              </div>
            </div>
            <div class="col-2">
              <p class="label label-v">Strand</p>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="switch-3" checked />
                <label class="form-check-label" for="switch-3">Single-stranded</label>
              </div>
            </div>
            <div class="col" id="legend-meth-bin">
              <p class="label label-v">Color legend</p>
              <span class="watson-marker">·</span>Watson strand <br />
              <span class="crick-marker">·</span>Crick strand
            </div>
            <div class="col-2"></div>
          </div>
          <div class="row">
            <div class="col-xl-12">
              <img src="../img/meth-bin-CG-single-dp1.png" alt="" id="img-meth-bin" />
            </div>
          </div>
        </article>
      </section>

      <section id="Methylation bias">
        <h2>Methylation bias</h2>

        <article id="meth-at-depth">
          <h3>Methylation level at different read depths</h3>
          <p>For cytosines of read <strong>depth = k</strong> ≥ 1.</p>
          <div class="row">
            <div class="col-9">
              <img src="../img/meth-CG-at-dp-k.svg" alt="" width="400px" id="img-meth-at-dp" />
              <div class="caption" link="#img-meth-at-dp">
                Ideally, methylation level should be independent with depth.
              </div>
            </div>
            <div class="col legend">
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-meth-at-dp" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-meth-at-dp" value="CHG" />
                <label class="form-check-label">CHG </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-meth-at-dp" value="CHH" />
                <label class="form-check-label">CHH </label>
              </div>
            </div>
          </div>
        </article>

        <article id="cul-meth-depth">
          <h3>Methylation level with different thresholds of read depth</h3>
          <p>For cytosines with read <strong>depth ≥ k</strong> ≥ 1.</p>
          <div class="row">
            <div class="col-9">
              <img src="../img/meth-CG-vs-dp-threshold.svg" alt="" width="400px" id="img-cul-meth-by-dp" />
              <div class="caption" link="#img-cul-meth-by-dp">
                Ideally, methylation level should be independent with depth.
              </div>
            </div>
            <div class="col legend">
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-5" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-5" value="CHG" />
                <label class="form-check-label">CHG </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-5" value="CHH" />
                <label class="form-check-label">CHH </label>
              </div>
            </div>
          </div>
        </article>

        <article id="meth-vs-missing-rate">
          <h3>
            Methylation level at different proportions of uncovered CpGs
          </h3>
          <p>
            The proportion of uncovered cytosines increases as the read depth
            threshold increases.
          </p>
          <div class="row">
            <div class="col-9">
              <img src="../img/meth-CG-vs-missing-rate.svg" alt="" width="400px" id="img-meth-vs-missing-rate" />
              <div class="caption" link="#img-meth-vs-missing-rate">
                Ideally, methylation level should be independent with depth.
              </div>
            </div>
            <div class="col legend">
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-meth-vs-missing-rate" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-meth-vs-missing-rate" value="CHG" />
                <label class="form-check-label">CHG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio-meth-vs-missing-rate" value="CHH" />
                <label class="form-check-label">CHH</label>
              </div>
            </div>
          </div>
        </article>

        <article id="meth-vs-cg-density">
          <h3>Mean methylation level vs cytosine density</h3>
          <p>
            For each binning window, <strong>cytosine density</strong> is defined as the number of cytosines per 1Kbp.
            Cytosines on two strands are summed for double-stranded plots.
          </p>
          <div class="row">
            <div class="col-9">
              <img src="../img/meth-vs-CG-density-of-double-strand-dp-ge1.png" alt="" width="400px"
                id="img-meth-vs-Cs-density" />
              <div class="caption" link="#img-meth-vs-Cs-density"></div>
            </div>
            <div class="col legend">
              <p class="label">
                Depth ≥ <span id="label-meth-vs-Cs-density">1</span>
              </p>
              <input type="range" class="form-range" min="1" max="10" step="1" id="range-meth-vs-Cs-density"
                value="1" />
              <p class="label">Cytosine context</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-meth-vs-Cs-density" value="CG" checked />
                <label class="form-check-label">CG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-meth-vs-Cs-density" value="CHG" />
                <label class="form-check-label">CHG</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio1-meth-vs-Cs-density" value="CHH" />
                <label class="form-check-label">CHH</label>
              </div>

              <p class="label">Strand</p>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-meth-vs-Cs-density" value="double" checked />
                <label class="form-check-label">Double</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-meth-vs-Cs-density" value="W" />
                <label class="form-check-label">Watson</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="radio2-meth-vs-Cs-density" value="C" />
                <label class="form-check-label">Crick</label>
              </div>
            </div>
          </div>
        </article>

        <article id="depth-distribution-of-low-high-meth-cpg">
          <h3>Depth distribution of hyper-/hypo-methylated cytosines</h3>
          <p>
            The depth is methylation depth, namely accounting for only C/T
            reads for Watson strand and G/A reads for Crick strand.
          </p>
          {# <object class="img" data="../img/depth-of-low-high-meth-CGs.svg" type="image/svg+xml" width="500px"></object> #}
          <img src="../img/depth-of-low-high-meth-CGs.png" alt="" width="450px" />
        </article>

      </section>

      <section id="CpG strandness">
        <h2>CpG strandness</h2>
        <p>Summarise the reads mapped onto double strands of CpGs. </p>
        <article id="CpG-stranded-depth">
          <h3>CpG depth strandness</h3>
          <p>
            The heatmap shows the number of CpGs (instead if cytosines) with
            different Watson (row) and Crick (column) read depths. Uncovered
            CpGs with coordinate (0,0) is removed for better visualization.
          </p>
          <img src="../img/heatmap-cg-stranded-depth.png" alt="" width="500px" />
        </article>
        <article id="CpG-depth-diff">
          <h3>Stranded depth difference</h3>
          <p><ul>
            <li>CpG depth difference = Watson depth - Crick depth </li>
            <li>mean of difference: , sd = </li>
            <li>mean of absolute difference: , sd = </li>
          </ul>
          </p>
          <img src="../img/cg-stranded-depth-difference.png" alt="" height="250px" />
        </article>
        <article id="CpG-double-stranded-coverage">
          <!-- <h3>CpGs with double-stranded coverage</h3> -->
          <p>
            Proportion of double-stranded covered CpGs at different depths.
            $$ \text{proportion of CpGs of double-stranded coverage} = \frac{\#\{
            \text{CpGs with Watson and Crick depths both} \ge \text{DP}\}}
            {\#\{ \text{CpGs with either Watson or Crick depths} \ge
            \text{DP}\}} $$
          </p>
          <img src="../img/cg-prop-of-double-stranded-coverage.png" alt="" height="300px" />
        </article>
        <article id="CpG-stranded-meth">
          <h3>CpG methylation strandness</h3>
          <p>
            The following heatmap shows the number of CpG of differ Watson and
            Crick strand methylation. All consensus CpGs with depth ≥ 1 are
            included.
          </p>
          <img src="../img/heatmap-cg-stranded-meth.png" alt="" width="500px" />
        </article>
        <article id="CpG-stranded-meth-diff">
          <h3>CpG stranded methylation difference</h3>
          <p>
            The following heatmap shows the number of CpGs with different
            methylation difference (Watson - Crick, y-axis) at different depth
            (x-axis), represented by $\min\{ \text{depth}_\text{Watson},
            \text{depth}_\text{Crick} \} $.
          </p>
          <img src="../img/heatmap-cg-stranded-meth-diff.png" alt="" height="400px" />
        </article>
      </section>

      <section id="CpG-motif">
        <h2>CpG-motif</h2>
        <article id="CpG-kmer-frequency">
          <h3>CpG-motif frequency</h3>
          <p>
            The CpG-motif in this report means
            <strong>NNCGNN</strong>, N ∈ {A, T, C, G}. There are 4<sup>4</sup>=256 different CpG-motifs.
            The following figure shows the histogram of relative frequency of each
            CpG-motif as the fold of mean proportion of 1/256 ≈ 0.0039.
          </p>
          <img src="../img/kmer-frequency-dist.png" alt="" height=250px" />

        </article>
        <article id="stranded-CpG-kmer-frequency">
          <h3>Stranded CpG-motif frequency</h3>
          <p>Relative frequency on two strands.</p>
          <!-- <img src="../img/kmer-stranded-frequency.png" alt="" width="500px" /> -->
          <div class="img" id="plot-freq-on-two-strands" style="width: 450px; height: 350px"></div>
        </article>
        <article id="stranded-CpG-kmer-meth">
          <h3>Stranded CpG-motif methylation</h3>
          <p>Mean methyaltion level a CpG-motif on two strands (depth ≥ 1).</p>
          <div class="img" id="plot-kmer-meth-on-two-strands" style="width: 450px; height: 350px"></div>
          <!-- <img src="../img/kmer-stranded-me-dp1.png" alt="" width="500px" /> -->
        </article>
        <article id="CpG-kmer-depth-vs-frequency">
          <h3>Mean depth vs frequency</h3>
          <div class="img" id="plot-depth-vs-freq" style="width: 450px; height: 350px"></div>
          <!-- <img src="../img/kmer-mean-depth-vs-freq.png" alt="" width="500px" /> -->
        </article>
        <article id="CpG-kmer-meth-vs-frequency">
          <h3>Mean methylation vs frequency</h3>
          <p>
            The methylation (depth ≥ 1) of a stranded CpG-motif is indicated by the central cytosine
            (NN<strong>C</strong>GNN).
          </p>
          <div class="img" id="plot-kmer-meth-vs-freq" style="width: 450px; height: 350px"></div>
          <!-- <img src="../img/kmer-meth-vs-frequency.png" alt="" width="500px" /> -->
        </article>
        <article id="CpG-kmer-coverage-vs-depth">
          <h3>Coverage rate vs read depth</h3>
          <p>
            Each line represents the coverage rate of specific CpG-motif with
            different thresholds of read depth.
          </p>
          <div class="img" id="plot-cov-vs-depth" style="width: 500px; height: 400px"></div>
          <!-- <img
              src="../img/cgmker-cul-coverage-vs-depth.png"
              alt=""
              width="60%"
            /> -->
        </article>
        <article id="CpG-kmer-meth-vs-depth">
          <h3>Mean methylation vs depth</h3>
          <p>
            Each line represents the mean methylation of specific CpG-motif
            with different thresholds of depth.
          </p>
          <div class="img" id="plot-me-vs-depth" style="width: 500px; height: 400px"></div>
          <!-- <img src="../img/cgkmer-cul-meth-vs-depth.png" alt="" width="60%" /> -->
        </article>
      </section>

      <section id="rrbs-kmer">
        <h2>RRBS</h2>
        <p>Reduced Representation Bisulfite Sequencing (RRBS) uses a methylation-insensitive restriction enzyme, usually
          <code>MspI</code> with the cutting target <code>5'CCGG3'</code> sequences, to enrich CpG-rich sequences.</p>

        <article id="RRBS-summary">
          <h3>RRBS CpGs summary</h3>
          <p>The proportion of CCGG-context CpGs over all CpGs in the genome is {{alldata.ccgg_prop}}% (lefttop figure). The
            mean single-stranded methylation read depth of CCGG-context CpGs is {{alldata.ccgg_mean_dp}} (leftbottom figure). The coverage
            rate and mean methyaltion level of CCGG- and non-CCGG-context CpGs with varing depth thresholds are shown in
            righttop and rightbottom figures, respectively.</p>
          <img src="../img/rrbs-kmer-summary.png" alt="" width="500px">
        </article>
      </section>

      <section id="pan-gene">
        <h2>Pan-gene methylation pattern</h2>
        <p>
          Average DNAme gene-related regions from TSS upstream 5kbp to TTS
          downstream 5kbp.
        </p>

        <article id="pan-gene-coding">
          <h3>Coding genes</h3>
          <p>Based on randomly selected {{alldata.PANGENE_SAMPLED}} (out of {{alldata.ngene_coding}}) coding genes.</p>
          <img src="../img/pan-gene-meth-coding.png" alt="" width="450px" />
        </article>
        <article id="pan-gene-lnc">
          <h3>Long non-coding genes</h3>
          <p>
            Based on randomly selected {{alldata.PANGENE_SAMPLED}} (out of {{alldata.ngene_lnc}}) long non-coding RNA
            (lncRNA) genes.
          </p>
          <img src="../img/pan-gene-meth-lncRNA.png" alt="" width="450px" />
        </article>
        <article id="pan-gene-other">
          <h3>Other non-coding genes</h3>
          <p>
            Based on randomly selected {{alldata.PANGENE_SAMPLED}} (out of {{alldata.ngene_noncoding}}) other non-coding
            genes, namely genes except coding and lncRNA genes.
          </p>
          <img src="../img/pan-gene-meth-other-noncoding.png" alt="" width="450px" />
        </article>
      </section>
    </div>

    <div class="col-2" id="col-caption">
      <!-- Captions -->
    </div>
  </div>

  <!-- custom CSS -->
  <link rel="stylesheet" href="assets/css/report.css" />
  <!-- custom JS -->
  <script src="assets/js/report.js"></script>
  <script src="assets/js/figures.js"></script>
</body>

</html>
